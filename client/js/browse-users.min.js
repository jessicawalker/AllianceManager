var app=angular.module("userdataTableApp",[]);function getDates(userdataArray){for(var dateExists,datesArray=[{value:"",display:"- All Dates -"}],i=0;i<userdataArray.length;i++)if(!(dateExists=datesArray.find((function(element){return element.value===userdataArray[i].date})))){var origDate,readableDate=new Date(userdataArray[i].date).toDateString();datesArray.push({value:userdataArray[i].date,display:readableDate})}return datesArray}function getUsers(userdataArray){for(var userExists,usersArray=[{value:"",display:"- All Users -"}],i=0;i<userdataArray.length;i++)(userExists=usersArray.find((function(element){return element.value===userdataArray[i].user})))||usersArray.push({value:userdataArray[i].user,display:userdataArray[i].user});return usersArray.sort((a,b)=>a.display.toLowerCase()>b.display.toLowerCase()?1:-1),usersArray}function getArray(userdataArray){for(var usersArrayJson=[],i=0;i<userdataArray.length;i++)usersArrayJson.push({date:userdataArray[i].date,user:userdataArray[i].user});return usersArrayJson}function toggleHide(value,tdClass,list){if(""!=value){if("date"==tdClass)for(var e in list)console.log(e.innerText);if("user"==tdClass)for(var f in list)console.log(f.innerText)}if(""==value){if("date"==tdClass)for(var g in list)console.log(g.innerText);if("user"==tdClass)for(var h in list)console.log(h.innerText)}}app.controller("userdataTableController",(function($scope,$http){$scope.userdata=[],$scope.dataArray=[],$scope.dates=[],$scope.users=[],$scope.sortBy=[{value:"date",display:"Date"},{value:"user",display:"User"},{value:"claimedSSWar",display:"Claimed SS - War Phase"},{value:"activeDeclare",display:"Active - Declare Phase"},{value:"defenseEarly",display:"Placed Defense Early"},{value:"defenseLive",display:"Placed Defense Live"},{value:"offense",display:"Placed Offense"},{value:"notes",display:"Notes"}],$scope.get_users=function(){$http({method:"GET",url:evgURL+"/read-records"}).then((function(response){"SUCCESS"===response.data.msg?($scope.userdata=response.data.userdata,$scope.dataArray=getArray(response.data.userdata),$scope.dates=getDates(response.data.userdata),$scope.users=getUsers(response.data.userdata),$scope.selectedDate=$scope.dates[0],$scope.selectedUser=$scope.users[0],$scope.selectedSortBy=$scope.sortBy[0]):console.log(response.data.msg)}),(function(response){console.log(response)}))},$scope.get_users(),$scope.redrawTable=function(){var sortByValue=$scope.sortBy[0],date=$scope.selectedDate.value,user=$scope.selectedUser.value;$http({method:"GET",url:evgURL+"/get-userdataByValue",params:{date:date,user:user}}).then((function(response){"SUCCESS"===response.data.msg?($scope.userdata=response.data.userdata,$scope.selectedSortBy=$scope.sortBy[0]):console.log(response.data.msg)}),(function(response){console.log(response)}))},$scope.redrawTableDate=function(){var sortByValue=$scope.sortBy[0],date=$scope.selectedDate.value;$http({method:"GET",url:evgURL+"/get-userdataByDate",params:{date:date}}).then((function(response){"SUCCESS"===response.data.msg?($scope.userdata=response.data.userdata,$scope.selectedSortBy=$scope.sortBy[0]):console.log(response.data.msg)}),(function(response){console.log(response)}))},$scope.redrawTableUser=function(){var sortByValue=$scope.sortBy[0],user=$scope.selectedUser.value;$http({method:"GET",url:evgURL+"/get-userdataByUser",params:{user:user}}).then((function(response){"SUCCESS"===response.data.msg?($scope.userdata=response.data.userdata,$scope.selectedSortBy=$scope.sortBy[0]):console.log(response.data.msg)}),(function(response){console.log(response)}))},$scope.sortTable=function(){var sortByValue=$scope.selectedSortBy.value,date=$scope.selectedDate.value;$http({method:"GET",url:evgURL+"/sort-records",params:{sortByKey:sortByValue,date:date}}).then((function(response){"SUCCESS"===response.data.msg?$scope.userdata=response.data.userdata:console.log(response.data.msg)}),(function(response){console.log(response)}))}}));